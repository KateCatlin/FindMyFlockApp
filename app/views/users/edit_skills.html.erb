<div class="container form-skills">
  <div class="row justify-content-center">

    <div class="col-xs-9">

      <!-- Tab panes -->
      <div class="tab-content active ">
        <%= form_for @user, url: edit_skills_return_user_path(@user), method: :post do |f| %>
        <% @skills_numeric_hash.each_with_index do |hash, index|  %>

        <div class="form-box" id="data-<%= index %>"<%= 'hidden' unless index == 0 %>>
          <div class="tab-pane active" id="personal-info" role="tabpanel">
            <h4 class="no-space"> How skilled are you with <em class="underlined-thin"><%= hash[0]%></em>? </h4>
            <br>
            <div class="form-check">
              <input class="form-check-input" data-form-id='<%= index %>' type="radio" name="skills-<%= index %>" value="<%=hash[0]%>1" checked>
              <label class="form-check-label">
                <p> Only a little knowledge</p>
              </label>
            </div>
            <div class="form-check">
              <input class="form-check-input" data-form-id='<%= index %>' type="radio" name="skills-<%= index %>" value="<%=hash[0]%>2">

              <label class="form-check-label">
                <p>Gaining competency</p>
              </label>
            </div>
            <div class="form-check">
              <input class="form-check-input" data-form-id='<%= index %>' type="radio" name="skills-<%= index %>" value="<%=hash[0]%>3" >

              <label class="form-check-label">
                <p>Individual competency</p>
              </label>
            </div>
            <div class="form-check">
              <input class="form-check-input" data-form-id='<%= index %>' type="radio" name="skills-<%= index %>" value="<%=hash[0]%>4" >

              <label class="form-check-label">
                <p>Strong competency</p>
              </label>
            </div>
            <div class="form-check">
              <input class="form-check-input" data-form-id='<%= index %>' type="radio" name="skills-<%= index %>" value="<%=hash[0]%>5" >

              <label class="form-check-label">
                <p>Expert</p>
              </label>
            </div>
            <br>



            <%= f.button :submit, :class => 'btn submit-btn '%>
          </div>
        </div>
        <% end %>

        <div class="form-box" id="data-<%= @skills_numeric_hash.length %>" hidden>
          <br>
          <ul class="skills-list">
            <% @skills_numeric_hash.each_with_index do |skill, index|  %>
            <li>
              <p class="bold"><%= skill[0].to_s.capitalize %></p>
              <p><%= current_user.competency_description(skill.slice(-1).to_i - 1) %></p>
            </li>
            <% end %>
          </ul>
          <br>
          <%= f.button :submit, :class => 'btn btn-wide btn-group-justified'%>
        </div>
        <% end %>

      </div>
   <div class="btn-group" role="group" aria-label="Button group with nested dropdown">
    <% @skills_numeric_hash.each_with_index do |hash, index|  %>
    <button type="button" class="btn skill-button <%= 'active-btn' if index == 0 %> " data-form-target="data-<%= index %>"><%= hash[0] %></button>
    <% end %>
    <br>
  </div>
    </div>
  </div>



</div>
</div>





<script>
       // Get all the form boxes
       const forms = document.querySelectorAll('.form-box')
      // Get all the skill buttons
      const buttons = document.querySelectorAll('.skill-button')
      // Get all the inputs fields
      const inputs = document.querySelectorAll('.form-check-input')
    // On each input add an eventListener
    inputs.forEach(input => {
      input.addEventListener('click', function(event) {
        // grab the index through the data-form-id custom html tag
        let currentIndex = input.getAttribute('data-form-id')
        // grab the box that is now NOT HIDDEN - or active
        let activeBox = document.getElementById(`data-${currentIndex}`)
        // changing the current index to an integer and going to the next one
        let nextIndex = parseInt(currentIndex) + 1;
        // Hidding the current box
        activeBox.hidden = true;
        let nextBox = document.getElementById(`data-${nextIndex}`)
        // Unhiding the next one
        nextBox.hidden = false;

        let nextId = nextBox.getAttribute('id')
        let activeBtn = document.querySelector(`[data-form-target=${nextId}]`)
        deactiveButtons(buttons);
        activeBtn.classList.add('active-btn');
      })
    })

    function deactiveButtons(buttons) {
      buttons.forEach(button => button.classList.remove('active-btn'))
    }

    buttons.forEach(button => {
      // listen for when a button gets clicked
      button.addEventListener('click', function(event){
        // remove the active state from all buttons except current
        deactiveButtons(buttons);
        event.target.classList.add('active-btn');

        forms.forEach(function(form) { form.hidden = true;})
        let formId = button.getAttribute('data-form-target')
        document.getElementById(formId).hidden = false;
      })
    })

  </script>








